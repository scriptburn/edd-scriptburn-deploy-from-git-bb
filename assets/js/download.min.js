(function($)
{
    $(document).ready(function() { scb_hook_download_rows ()});
})(jQuery);

function scb_hook_download_rows()
{
    var scb_hook_found = false;
    jQuery('#edd_download_files').find('.edd_repeatable_upload_wrapper,.edd_repeatable_row').filter('[data-key]').each(function(key, value)
    {
        if (typeof scb_download_deploy['hooks'][$(value).find('.edd_repeatable_attachment_id_field').val()] !== 'undefined')
        {
            scb_hook_found = true;
        }
    });
    if (scb_hook_found)
    {
        //jQuery('#edd_download_files>#edd_file_fields>table>thead>tr').prepend('<th style="width:20px;padding-left:5px;padding-right:0px"></th>');
        jQuery('#edd_download_files').find('.edd_repeatable_upload_wrapper,.edd_repeatable_row').each(function(key, value)
        {
            if (typeof scb_download_deploy['hooks'][$(value).find('.edd_repeatable_attachment_id_field').val()] !== 'undefined')
            {
                hooked = scb_download_deploy['hooks'][$(value).find('.edd_repeatable_attachment_id_field').val()];
                $(value).find('.edd-repeatable-row-standard-fields').prepend(hooked['html']);
                $(value).find(".edd_repeatable_upload_field").after("<div style='color:green'>Source " + hooked['repo'] + "</div>");
                if (typeof hooked['hook_error'] !== 'undefined' && hooked['hook_error'] !== null && hooked['hook_error'].length)
                {
                    $(value).find(".edd_repeatable_upload_field").after("<div style='color:red'>Hook Error: " + hooked['hook_error'] + "</div>");
                }
            }
            else
            {
                $(value).prepend('<td style="width:20px;padding-left:0px;padding-right:5px"></td>');
            }
        });
    }
    if (!$('#edd_download_files>#edd_file_fields>table>tfoot').length)
    {
        $('#edd_download_files>#edd_file_fields>table').append('<tfoot></tfoot>');
    }
    var tr_len = $('#edd_download_files>#edd_file_fields>table>tbody>tr:first').find('td').length; //$('#edd_download_files>#edd_file_fields>table>tbody>tr').length;
    if ($('#edd_download_files>#edd_file_fields>table>tfoot').length)
    {
        $('#edd_download_files>#edd_file_fields>table>tfoot').append('<tr><td   ' + (tr_len > 1 ? 'colspan="' + tr_len + '"' : '') + '>' + scb_download_deploy.html + '</td></tr>');
    }
}